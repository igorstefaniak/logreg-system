<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="Igor Stefaniak">
    <meta name="copyright" content="Igor Stefaniak">
    <meta name="theme-color" content="#">
    <link rel="icon" href="http://example.com/favicon.png">
    <title>Document</title>
    <link href='https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="./styles/main-style.css">
    <link rel="stylesheet" href="./styles/web-el-style.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
    <script src="./scripts/main.js"></script>
</head>

<body>
    <div id="container">
        <form class="form" action="./index.html" method="get" target="_blank">
            <div class="input-container">
                <input type="text" name="name" placeholder="Jan Kowalski" class="input-field" id="user-name"
                    pattern="^([a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð]{1,}\s[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð]{1,}'?-?[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð]{1,}\s?([a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð]{1,})?)"
                    required />
                <label for="user-input">Imię i nazwisko*</label>
                <i id="user-icon" class="icon bx bx-square"></i>
            </div>
            <div class="input-container">
                <input type="email" name="email" placeholder="nazwauzytkownika@domena.pl" class="input-field"
                    id="email-input" required />
                <label for="email-input">Adres e-mail*</label>
                <i id="email-icon" class="icon bx bx-envelope"></i>
            </div>
            <div class="input-container">
                <input type="password" name="password" placeholder="••••••••" class="input-field" id="password-input"
                    minlength="8" required />
                <label for="password-input">Hasło*</label>
                <i id="password-icon" class="icon bx bx-lock-alt"></i>
            </div>
            <div class="input-container">
                <input type="date" name="date" class="input-field" id="date-input" placeholder="Date" min="1900-01-01"
                    max="2010-01-01" required />
                <label for="date-input">Data urodzenia</label>
                <i id="date-icon" class="icon bx bx-cake"></i>
            </div>
            <div class="input-container">
                <input type="tel" name="tel" class="input-field" id="tel-input" pattern="[0-9]{3}-[0-9]{3}-[0-9]{3}"
                    maxlength="11" required placeholder="123-456-789" />
                <label for="tel-input">Numer telefonu</label>
                <i id="tel-icon" class="icon bx bx-phone"></i>
            </div>
            <div class="input-container">
                <input type="text" name="postal-code" class="input-field" id="postal-code-input"
                    pattern="[0-9]{2}-[0-9]{3}" maxlength="6" placeholder="00-000" required/>
                <label for="postal-code-input">Kod pocztowy</label>
                <i id="postal-code-icon" class="icon bx bx-map"></i>
            </div>
            <div class="input-container">
                <input type="text" class="input-field" list="city" id="city-input" placeholder="Pacanów" name="city" required/>
                <label for="city-input">Miejscowość</label>
                <datalist id="city"></datalist>
                <i id="city-icon" class="icon bx bx-home"></i>
            </div>
            <button type="submit" class="submit">Wyślij formularz</button>
        </form>
    </div>

    <script>
        const password = document.getElementById("password-input");

        $("#password-input").keyup(validatePassword);

        function validatePassword() {
            const regex_pattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;

            if (regex_pattern.test(password.value)) {
                $("#password-input").addClass("valid")
                $("#password-input").removeClass("invalid")

            }
            else {
                $("#password-input").addClass("invalid")
                $("#password-input").removeClass("valid")
            }

            if (!password.value) {
                $("#password-input").removeClass("valid")
                $("#password-input").removeClass("invalid")
            }
        }

        const email = document.getElementById("email-input");

        $("#email-input").keyup(validateEmail);

        function validateEmail() {
            const regex_pattern = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

            if (regex_pattern.test(email.value)) {
                $("#email-input").addClass("valid")
                $("#email-input").removeClass("invalid")

            }
            else {
                $("#email-input").addClass("invalid")
                $("#email-input").removeClass("valid")
            }

            if (!email.value) {
                $("#email-input").removeClass("valid")
                $("#email-input").removeClass("invalid")
            }
        }

        const tel = document.getElementById("tel-input");

        $("#tel-input").keyup(addHyphen);

        function addHyphen() {

            let ele = tel;
            ele = ele.value.split('-').join('');

            let finalVal = ele.match(/.{1,3}/g).join('-');
            tel.value = finalVal;
        }

        const pc = document.getElementById("postal-code-input");

        $("#postal-code-input").keyup(addHyphenPostalCode);

        function addHyphenPostalCode() {
            let ele = pc;
            ele = ele.value.split('-').join('');

            let finalVal = ele.match(/^[0-9]{2}|.{1,3}/g).join('-');
            pc.value = finalVal;
            if (pc.value.match(/^[0-9]{2}-[0-9]{3}$/g)){
                $( "#city" ).empty()
                getCityName()
            }
        }

        function getCityName() {
            var url = "https://kodpocztowy.intami.pl/api/" + pc.value;
            $.getJSON(url, function (r) {
                Object.entries(r).forEach(([key, value]) => {
                $( "#city" ).append( "<option>" + value.miejscowosc + " " + (typeof value.ulica === "undefined" ? "" : value.ulica) + "</option>");
            });
            });
        }

    </script>
</body>